addEventListener("message",({data:r})=>{let a=g(r.users,r.groupBy);postMessage(a)});function g(r,a){let s=new Map;for(let e of r){let n;switch(a){case"alphabetical":{n=e.firstname?e.firstname.charAt(0).toUpperCase():"Unknown";break}case"nationality":{n=e.nat||"Unknown";break}case"age":{n=l(e.age||0).key;break}case"gender":{n=e.gender||"Unknown";break}default:n="All"}s.has(n)||s.set(n,[]),s.get(n).push(e)}return{groups:Array.from(s.entries()).map(([e,n])=>{let i=[...n].sort((o,u)=>(o.firstname||"").localeCompare(u.firstname||"")),t;return e==="Unknown"?t="Unknown":a==="nationality"?t=p(e):a==="age"?t=l(Number.parseInt(e.split("-")[0])||0).label:a==="gender"?t=e.charAt(0).toUpperCase()+e.slice(1):t=e,{key:e,label:t,users:i,count:n.length}}).sort((e,n)=>e.key==="Unknown"?1:n.key==="Unknown"?-1:e.key.localeCompare(n.key))}}function l(r){return r<18?{key:"0-17",label:"Under 18"}:r<25?{key:"18-24",label:"18-24 years"}:r<35?{key:"25-34",label:"25-34 years"}:r<45?{key:"35-44",label:"35-44 years"}:r<55?{key:"45-54",label:"45-54 years"}:r<65?{key:"55-64",label:"55-64 years"}:{key:"65+",label:"65+ years"}}function p(r){return{AU:"Australia",BR:"Brazil",CA:"Canada",CH:"Switzerland",DE:"Germany",DK:"Denmark",ES:"Spain",FI:"Finland",FR:"France",GB:"United Kingdom",IE:"Ireland",IN:"India",IR:"Iran",MX:"Mexico",NL:"Netherlands",NO:"Norway",NZ:"New Zealand",RS:"Serbia",TR:"Turkey",UA:"Ukraine",US:"United States"}[r]||r}
